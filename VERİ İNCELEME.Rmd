---
title: "Statistical Computing-Data Analysis Report- Sokak Hayvanları Veri Seti incelemesi"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

# Statistical Computing
##Data Analysis Report 
###Rüzgar Üren 1107090006 

#Sokak Hayvanları Veri Seti incelemesi



```{r, message=FALSE, include=TRUE}
library(vcd)
library(plyr)
library(ggplot2)
library(dplyr)
library(car)
library(psych)
```

#Verileri yükleme işlemleri

```{r, include=TRUE}
kisirlastirilan <- read.csv("kisirlastirilan.csv")
muayene <- read.csv("muayene.csv")
mudahale <- read.csv("müdehale.csv")
knitr::opts_chunk$set(echo = TRUE)
```




#Kısırlaştırılan sokak hayvanları veri setindeki değişkenlerin türünü değiştirme işlemleri

```{r}
#Karakter->Factor
kisirlastirilan$ILCE<-as.factor(kisirlastirilan$ILCE)
#Karakter->Factor
kisirlastirilan$MAHALLE<-as.factor(kisirlastirilan$MAHALLE)
#Karakter->Factor
kisirlastirilan$KISIRLASTIRILAN_HAYVAN_NOKTALARI<-as.factor(kisirlastirilan$KISIRLASTIRILAN_HAYVAN_NOKTALARI)
#Integer->Factor
kisirlastirilan$YIL<-as.factor(kisirlastirilan$YIL)
#Integer->Factor
kisirlastirilan$AY<-as.factor(kisirlastirilan$AY)
```





#Muayene ve Müdahale edilen sokak hayvanlarını karşılaştırmak için veri birleştirme işlemleri

```{r}
a <- cbind(muayene$YIL,muayene$AY,muayene$ADET,mudahale$ADET)
Birlestirilmis.Veri <- data.frame(a)
```




#Birlestirilmis verideki değişkenlere isim atama işlemleri

```{r}
names(Birlestirilmis.Veri)[1] <- "Yil"
names(Birlestirilmis.Veri)[2] <- "Ay"
names(Birlestirilmis.Veri)[3] <- "Muayene_Adedi"
names(Birlestirilmis.Veri)[4] <- "Mudahale_Adedi"
```




##Birleştirilmiş verideki yıl değişkenini integerden factor değişkenine çevirme işlemi


```{r}
#Integer->Factor
Birlestirilmis.Veri$Yil<-as.factor(Birlestirilmis.Veri$Yil)
```




# Veri Görselleştirme ve Tanımlayıcı İstatistikler

```{r}
ggplot(Birlestirilmis.Veri,aes(Muayene_Adedi,Mudahale_Adedi, color=Yil)) +
  geom_point() +
  facet_wrap(~Yil)+
  xlab("Muayene SayÄ±sÄ±") +
  ylab("MÃ¼dahalae SayÄ±sÄ±") +
  ggtitle("YÄ±la GÃ¶re Muayene ve MÃ¼dahale SayÄ±larÄ±")
```


##Kısırlaştırılan sokak hayvanları veri setini ilçeye ve adete göre bar grafigi üzerinde inceleyelim.


```{r}
ggplot(kisirlastirilan,aes(x=ILCE,y=ADET))+geom_bar(stat = "identity",fill="Blue")
```



##Tüm veri setlerine ait tanımlayıcı istatiskleri inceleyelim.

```{r}
describe(kisirlastirilan)
describe(muayene)
describe(mudahale)
```







#Güven Aralığı
##Muayene edilen sokak hayvanları veri setindeki adet değişkeninin güven aralığı

```{r}
n=16
muayene_adet_ort=mean(muayene$ADET)
muayene_adet_sd=sd(muayene$ADET)
cbind(muayene_adet_ort,muayene_adet_sd)
error <- qnorm(0.975)*muayene_adet_sd/sqrt(n)
alt_sinir <- muayene_adet_ort-error
üst_sinir <- muayene_adet_ort+error
cbind(alt_sinir,üst_sinir)
```



```{r}
n=16
muayene_adet_ort=mean(muayene$ADET)
muayene_adet_sd=sd(muayene$ADET)
cbind(muayene_adet_ort,muayene_adet_sd)
error <- qnorm(0.975)*muayene_adet_sd/sqrt(n)
alt_sinir <- muayene_adet_ort-error
üst_sinir <- muayene_adet_ort+error
cbind(alt_sinir,üst_sinir)
```


##Müdahale edilen sokak hayvanları veri setindeki adet değişkeninin güven aralığını inceleyelim


```{r}
n=16
mudahale_adet_ort=mean(mudahale$ADET)
mudahale_adet_sd=sd(mudahale$ADET)
cbind(mudahale_adet_ort,mudahale_adet_sd)
error <- qnorm(0.975)*mudahale_adet_sd/sqrt(n)
alt_sinir <- mudahale_adet_ort-error
üst_sinir <- mudahale_adet_ort+error
cbind(alt_sinir,üst_sinir)
```





# Hipotez Testleri
##Kısırlaştırılan sokak hayvanları veri setindeki kısırlaştırılan hayvan noktası ve yıl arasında ilişki olup olmadığını inceleyelim.
### H0:Kısırlastırılan hayvan noktası ve yıl arasında ilişki yoktur.
### H1:Kısırlaştırılan hayvan noktası ve yıl arasında ilişki vardır.

####Bunun için ki-kare testi kullanalım.

```{r}
ct=table(kisirlastirilan$KISIRLASTIRILAN_HAYVAN_NOKTALARI,kisirlastirilan$YIL)
print(ct)
chisq.test(ct)
assocstats(ct)
```






```{r}
#Normallik Testi
shapiro.test(muayene$ADET)
shapiro.test(mudahale$ADET)


#Varyans Homojenliği Testi
birlestirilmis.degisken=c(muayene$ADET,mudahale$ADET)
muayene.uzunluk =length(muayene$ADET)
mudahale.uzunluk=length(mudahale$ADET)
muayene.belirtec=rep(1,muayene.uzunluk)
mudahale.belirtec=rep(2,mudahale.uzunluk)
bileske.belirtec=c(muayene.belirtec,mudahale.belirtec)
test = leveneTest(birlestirilmis.degisken,bileske.belirtec)
print(test)

#Bağımsız Örneklem T Testi
ttest=t.test(muayene$ADET,mudahale$ADET,var.equal = TRUE)
if(ttest$p.value<0.05) {
  print("Muayene ve mÃ¼dehale edilen sokak hayvanlarÄ± arasÄ±nda anlamlÄ± farklÄ±lÄ±k vardÄ±r.")
  print(ttest)
} else {
  print("Muayene ve mÃ¼dehale edilen sokak hayvanlarÄ± arasÄ±nda anlamlÄ± farklÄ±lÄ±k yoktur.")
  print(ttest)
}
```



##Kısırlaştırılan sokak hayvanları adetlerinin ilçeye göre farklılık gösterip göstermediğini inceleyelim.
### H0: Kısırlaştırılan sokak hayvanları adetleri ilçeye göre farklılık göstermemektedir. ### H1: Kısırlaştırılan sokak hayvanları adetleri ilçeye göre farklılık göstermektedir.
#### Bunun için tek yönlü ANOVA testini kullanalım.


```{r}
#Normallik Testi
shapiro.test(kisirlastirilan$ADET)

#Varyans Homojenligi Testi
leveneTest(kisirlastirilan$ADET,kisirlastirilan$ILCE)

#Tek Yönlü ANOVA Testi
anova = aov(ADET~ILCE, data = kisirlastirilan)
summary(anova)
```


####Bu farklılığın hangi ilçelerden kaynaklandığını incelemek için Bonferroni ikili karşılaştırma testi kullanılmıştır.

```{r}
ikili.karsilastirma = pairwise.t.test(kisirlastirilan$ADET, kisirlastirilan$ILCE,
                                      p.adjust.method = "bonferroni",
                                      pool.sd = FALSE)
print(ikili.karsilastirma)
```



# ANOVA veya Regresyon
## HİPOTEZ 1: 
### Kısırlaştırılan sokak hayvanları adetlerinin aylara göre farklılık gösterip göstermediğini inceleyelim.
####H0: Kısırlaştırılan sokak hayvanları adetleri aya göre farklılık göstermemektedir.
####H1: Kısırlaştırılan sokak hayvanları adetleri aya göre farklılık göstermektedir.

```{r}
#Normallik Testi
shapiro.test(kisirlastirilan$ADET)

#Varyans Homojenligi Testi
leveneTest(kisirlastirilan$ADET,kisirlastirilan$AY)

#Tek YÃ¶nlÃ¼ ANOVA Testi
anova.sonucu = aov(ADET~AY, data = kisirlastirilan)
summary(anova.sonucu)
```








#RÜZGAR üREN
#1107090006
#MUĞLA SITKI KOÇMAN ÜNİVERSİTESİ
#LECTURER: Dr. ZEYNEP FİLİZ EREN DOĞU




